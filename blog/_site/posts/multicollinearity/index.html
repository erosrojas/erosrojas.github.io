<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.654">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Eros Rojas">
<meta name="dcterms.date" content="2023-01-08">

<title>Home - Multicollinearity: An Intuitive Example</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="../../site_libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Home</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">About Me</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/erosrojas"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://erosrojas.github.io/test.html"><i class="bi bi-card-list" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Multicollinearity: An Intuitive Example</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                                <div class="quarto-categories">
                <div class="quarto-category">R</div>
                <div class="quarto-category">Statistics</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Eros Rojas </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 8, 2023</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="an-intuitive-visualization-of-collinearity" class="level2">
<h2 class="anchored" data-anchor-id="an-intuitive-visualization-of-collinearity"><strong>An intuitive visualization of collinearity</strong></h2>
<p>Visualized in 3 dimensions, with the help of plotly.</p>
<p><br> <img src="3d.jpg" class="img-fluid"> <br> <br></p>
<section id="understanding-what-collinearity-is" class="level3">
<h3 class="anchored" data-anchor-id="understanding-what-collinearity-is"><strong>Understanding what collinearity is:</strong></h3>
<p>As defined by <a href="https://en.wikipedia.org/wiki/Multicollinearity" target="_blank">Wikipedia</a>, “<em>multicollinearity (also collinearity) is a phenomenon in which one predictor variable in a multiple regression model can be linearly predicted from the others with a substantial degree of accuracy.</em>” Essentially, this means that an input variable (or multiple variables) is highly correlated with another input variable, to the extent that their relationship is virtually linearly dependent. This can cause numerous issues with respect to the regression analysis, most notably causing:</p>
<ul>
<li>
Inflated standard error
</li>
<li>
Uninterpretable + Unstable coefficients
</li>
</ul>
<p>All of these issues will be explained in the following 3 sections. <br> <br></p>
<section id="inflated-standard-error" class="level4">
<h4 class="anchored" data-anchor-id="inflated-standard-error"><strong>Inflated standard error:</strong></h4>
<p>The standard error of the coefficients of a linear model can be calculated as follows: <br><br> Lets assume a linear model has the following loss function</p>
<p><span class="math display">\[f(w) = ||Xw + \epsilon - \hat{y}||_2\]</span></p>
<p>where <span class="math inline">\(\epsilon\)</span> represents the error terms which follow a normal distribution, such that <span class="math inline">\(\epsilon \sim N(0, \sigma^2)\)</span>. Since the given loss function above is fully differentiable and convex, we can find a closed-form solution for its coefficients as</p>
<p><span class="math display">\[w = (X^TX)^{-1}X^T\hat{y}\]</span></p>
<p>Now that the coefficients are isolated, finding the variance should be quite straight forward. <span class="math display">\[\begin{align}
\mathrm{Var}(w) &amp;= \mathrm{Var}\left((X^TX)^{-1}X^T \hat{y} \right) \\
&amp;= (X^TX)^{−1}X^T \cdot \mathrm{Var}(\hat{y}) \cdot X(X^TX)^{−1} \\
&amp;= \sigma^2 (X^T X)^{-1}
\end{align}\]</span> <em>Note: <span class="math inline">\(\mathrm{Var}(\hat{y}) = \mathrm{Var}(\epsilon)\)</span> due to the fact that <span class="math inline">\(\hat{y} = Xw + \epsilon\)</span>, and <span class="math inline">\(Xw\)</span> has a variance of 0 (since <span class="math inline">\(Xw\)</span> is not a random variable)</em>. <br><br> It is clear that <span class="math inline">\(X^T X\)</span> must be a square matrix, therefore, it can be diagonalized such that</p>
<p><span class="math display">\[X^T X = PDP^{-1}\]</span></p>
<p>where <span class="math inline">\(P\)</span> is an invertible matrix containing linearly independent eigenvectors of <span class="math inline">\(X^T X\)</span>, and <span class="math inline">\(D\)</span> is a diagonal matrix containing the eigenvalues of <span class="math inline">\(X^T X\)</span> (you can read more about matrix diagonalization <a href="https://www.statlect.com/matrix-algebra/matrix-diagonalization" target="_blank">here</a>). Most notably, the product of the entries of <span class="math inline">\(D\)</span> (the eigenvalues) are equal to the determinant of <span class="math inline">\(D\)</span>. When multicollinearity is present, <span class="math inline">\(X^T X\)</span> becomes ‘nearly singular’ (a matrix which has a determinant very close to <span class="math inline">\(0\)</span>, and who’s columns are nearly linearly dependent. For reference, a non-singular matrix is linearly independent, and a singular matrix is linearly dependent and has a determinant of <span class="math inline">\(0\)</span>). In other words, this means that one or more of the eigenvalues of <span class="math inline">\(D\)</span> must be very close to <span class="math inline">\(0\)</span>, or in fact <span class="math inline">\(0\)</span>. Given the inverse of the diagonalized matrix above;</p>
<p><span class="math display">\[(X^T X)^{-1} = PD^{-1}P^{-1}\]</span></p>
<p>this means that with multicollinearity, <span class="math inline">\(D^{-1}\)</span> must have very large values. This is due to the fact that when the inverse of a matrix is taken, its determinant is essentially divided out from each element of the resulting matrix (this is an oversimplification, look into <a href="https://en.wikipedia.org/wiki/Adjugate_matrix" target="_blank">adjugate matrices</a> if you are interested). This causes <span class="math inline">\((X^T X)^{-1}\)</span> to subsequently also have very large values, which finally causes <span class="math inline">\(\mathrm{Var}(w)\)</span> to be very large. This shows why multicollinearity severely inflates the standard error of the coefficients. <br> <br></p>
</section>
<section id="uninterpretable-unstable-coefficients" class="level4">
<h4 class="anchored" data-anchor-id="uninterpretable-unstable-coefficients"><strong>Uninterpretable + Unstable coefficients:</strong></h4>
</section>
</section>
<section id="intuition-behind-the-instability" class="level3">
<h3 class="anchored" data-anchor-id="intuition-behind-the-instability"><strong>Intuition behind the instability:</strong></h3>
<p>It might be a little difficult to digest exactly why the coefficients become highly unstable from the above explanation. To help give a visual aspect to the problem of collinearity, the following simulation was created to replicate the effects, and issues that arise with collinear features.</p>
<div class="cell">
<details open="">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># installing packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("plotly", repos = "http://cran.us.r-project.org")</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>artificial_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">1000</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">x2 =</span> x1 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> (x1 <span class="sc">+</span> x2 <span class="sc">+</span> <span class="fu">runif</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="dv">500</span>))<span class="sc">/</span><span class="dv">4</span>) </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>artificial_data <span class="sc">%&gt;%</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cor</span>()</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#change the values inside of slice to subset the data differently (this will drastically change the coefficients of x1 and x2 since they are colinear)</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> <span class="fu">slice</span>(artificial_data, <span class="dv">200</span><span class="sc">:</span><span class="dv">700</span>))</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>lm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          x1        x2         y
x1 1.0000000 0.9999936 0.9699297
x2 0.9999936 1.0000000 0.9699606
y  0.9699297 0.9699606 1.0000000

Call:
lm(formula = y ~ x1 + x2, data = slice(artificial_data, 200:700))

Coefficients:
(Intercept)           x1           x2  
    61.2069       0.3390       0.1622  </code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">x1 =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1000</span>, <span class="at">by =</span> <span class="dv">200</span>), <span class="at">x2 =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1000</span>, <span class="at">by =</span> <span class="dv">200</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">preds =</span> <span class="fu">predict</span>(lm, <span class="at">newdata =</span> <span class="fu">data.frame</span>(x1, x2))) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> x1, <span class="at">values_from =</span> preds) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.matrix</span>()</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(mtcars, <span class="at">x =</span> <span class="sc">~</span>artificial_data<span class="sc">$</span>x1, <span class="at">y =</span> <span class="sc">~</span>artificial_data<span class="sc">$</span>x2, <span class="at">z =</span> <span class="sc">~</span>artificial_data<span class="sc">$</span>y, <span class="at">alpha =</span> <span class="fl">0.25</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_markers</span>()</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">layout</span>(<span class="at">scene =</span> <span class="fu">list</span>(<span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'x1'</span>),</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'x2'</span>),</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">zaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'y'</span>, <span class="at">nticks =</span> <span class="dv">5</span>, <span class="at">range =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1000</span>))))</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">add_trace</span>(<span class="at">p =</span> fig,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">z =</span> grid,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1000</span>, <span class="at">by =</span> <span class="dv">200</span>),</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1000</span>, <span class="at">by =</span> <span class="dv">200</span>),</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">type =</span> <span class="st">"surface"</span>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="htmlwidget-66c06aaa71fc60dd7d90" style="width:100%;height:464px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-66c06aaa71fc60dd7d90">{"x":{"visdat":{"38c4665b5539":["function () ","plotlyVisDat"]},"cur_data":"38c4665b5539","attrs":{"38c4665b5539":{"x":{},"y":{},"z":{},"alpha":0.25,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","inherit":true},"38c4665b5539.1":{"x":[0,200,400,600,800,1000],"y":[0,200,400,600,800,1000],"z":[[61.2068979626935,129.015027692809,196.823157422925,264.631287153041,332.439416883157,400.247546613273],[93.6518722591435,161.460001989259,229.268131719375,297.076261449491,364.884391179607,432.692520909723],[126.096846555594,193.904976285709,261.713106015825,329.521235745941,397.329365476057,465.137495206173],[158.541820852043,226.349950582159,294.158080312275,361.966210042391,429.774339772507,497.582469502623],[190.986795148493,258.794924878609,326.603054608725,394.411184338841,462.219314068957,530.027443799073],[223.431769444943,291.239899175059,359.048028905175,426.856158635291,494.664288365407,562.472418095523]],"alpha":0.25,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"x1"},"yaxis":{"title":"x2"},"zaxis":{"title":"y","nticks":5,"range":[0,1000]}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999,1000],"y":[0.373546189257668,2.18364332422208,2.16437138758995,5.59528080213779,5.32950777181536,5.17953161588198,7.48742905242849,8.73832470512922,9.57578135165349,9.69461161284364,12.5117811684508,12.3898432364114,12.3787594194582,11.7853001128225,16.1249309181431,15.9550663909848,16.9838097369011,18.9438362106853,19.8212211950981,20.5939013212175,21.9189773716082,22.7821363007311,23.0745649833652,22.0106483041366,25.6198257478947,25.943871260471,26.8442044932947,26.5292476161007,28.5218499448914,30.4179415601997,32.358679551529,31.897212272657,33.3876716115594,33.9461949594171,33.6229404431714,35.5850054367003,36.6057100462897,37.9406866032888,40.1000253719839,40.7631757484575,40.8354764037464,41.7466383198635,43.6969633754047,44.5566631986737,44.3112443054505,45.2925048430379,47.3645819621368,48.7685329245154,48.8876537878498,50.8811077264542,51.3981058803671,51.3879736067492,53.3411196914244,52.8706369039192,56.433023701701,57.9803998985059,56.6327785235335,56.9558653736835,59.5697196274424,59.8649453961192,63.4016177605048,61.9607599972668,63.6897393624508,64.0280021587807,64.2567267911176,66.1887922995143,65.195041371109,69.4655548615629,69.1532533382119,72.1726116703622,71.4755095288997,71.2900535690782,73.6107263534891,73.0659023683558,73.7463665997609,76.2914462355175,76.5567081267816,78.0011053516316,79.0743413241517,79.4104790538119,80.4313312671815,81.8648213848762,84.1780869965732,82.4764331995702,85.5939461876284,86.3329503712135,88.0630998372764,87.6958160763657,89.3700188099163,90.2670987907722,90.4574799690083,93.2078678059832,94.1604026156949,94.700213649515,96.5868334545409,96.5584864255653,95.723407791542,97.4267345857631,97.7753873851016,99.5265993635607,100.379633322776,102.042115873144,102.089078351448,104.158028772404,104.345415356081,107.767287269373,107.716707476017,108.910174229495,109.384185357826,111.682176080519,110.364263546051,111.538355269639,114.432282238542,113.34930364669,114.792619256398,115.607192070558,116.680007131451,117.720886697023,119.494188331268,119.82266951773,120.494042537886,123.34303882517,122.785420591453,123.820443469957,124.899809258786,126.712666307051,126.926435595874,127.962365828533,128.318339521244,129.675729727754,131.060160440435,131.41110551374,133.531496192633,132.481605918213,135.30655786079,134.463550176462,136.699023873163,137.471720095555,138.347905219319,139.943103222153,139.08564057432,143.176583312019,141.335027563788,143.536469598528,143.884079894957,145.249180998807,149.087166545628,148.017395619693,147.713699469566,148.359394465581,151.450187101273,151.981440167285,152.681931625456,153.070637852546,153.512539689859,154.924807703384,158.000028803714,157.378733305203,157.615573152615,161.869290622424,161.425100377372,161.761352899087,164.058483048709,164.886422651375,164.380756951769,168.20610246454,166.744972969859,166.575505349787,168.855600398046,170.207538339232,173.307978399059,172.105802367894,173.456998805423,173.922847064643,174.665999157633,175.965273971689,177.78763960563,180.075245008652,180.027392438764,181.207908398387,179.768676578442,182.983895570053,183.219924803661,182.532749970908,185.521022742648,185.841245395284,188.46458731197,187.233918000395,188.569788246071,189.073890502623,190.822896038563,192.402011779486,192.26825182688,194.830373167982,193.791917213696,194.952015587192,198.441157706844,196.984152534695,199.411974712318,199.618923948891,201.409401839651,203.688873286204,204.586588433442,203.669092199317,202.714764464708,208.497661589834,207.667066166765,208.541327335964,208.986600476854,210.510108422953,210.83562416823,212.420694643255,212.599753256022,212.629792122453,215.987838267455,217.5197450255,216.691259430774,216.746710244392,219.642241305678,219.955290863106,219.266781593175,222.00213185968,222.369699666072,223.65903142014,223.843427637364,227.803141907917,226.668867963609,226.394486587747,229.197193438739,230.263175646405,230.014173299591,229.11107932832,232.359518297435,234.57050763592,234.940276723957,235.901821255995,237.56082072862,236.813541361421,240.096777044274,239.994655971722,241.707310667398,243.034107734737,243.223480414915,243.121292387134,246.162964555967,243.999835055215,246.455209259998,247.744329290843,248.833878963235,251.020463908784,251.136221893103,252.407167603424,252.930345186987,253.752335658381,255.69555080662,257.146228357216,254.596903785108,258.572739555246,259.374724406779,259.574732278444,261.951012807577,261.610762818282,262.7156693382,264.85740977808,266.719627299121,266.270054900937,266.577815990212,266.81088670514,268.668967021121,269.06017067349,270.741067416881,272.394379168222,272.148142907976,276.649166881095,275.156011675665,277.130207267455,274.71087602016,278.741001157195,277.683754839548,280.919803677609,281.398130155452,281.59247142073,284.324258630177,283.298768330753,284.419385695759,284.998927818975,286.331821393247,288.945184953373,289.433702149545,291.005159217677,290.609881335946,292.376370291775,293.244164924486,292.573742657617,296.778429287475,296.134447660934,297.765598999158,298.955136676909,298.949434298558,299.694184580233,301.893673702426,300.952701850939,304.971337386224,303.616367893712,306.654145302275,307.512212693951,307.082965733586,308.567220914851,307.975451520466,310.323006503022,312.043612458356,312.099078486897,312.545863090846,313.34421814755,314.964077577378,317.069161460677,316.516025069699,317.878989888673,317.705859996179,320.494312836015,322.307901520114,323.497041009403,323.814702730897,322.130211209797,325.482029504124,326.456135603301,326.64659971417,328.170489470948,328.135964045873,330.679230774016,330.672898985347,330.430917814856,332.63254924383,335.36443492907,334.665718635269,336.732750042209,337.946585640198,338.004398704326,338.64767769445,339.470304490867,341.739589225575,340.936542584517,343.246210843536,343.710500633436,342.735110643512,344.591149543927,347.916019328793,347.808721049465,349.803283216134,351.887474463309,352.473881181109,352.677268492313,353.379962686567,353.807201573543,356.577891794904,356.596234109318,355.826423059129,357.84435746511,357.08109017973,359.804741153889,358.407672330054,363.314002167198,362.364456998968,363.570021161306,364.830681667698,366.612218173989,367.678340177223,368.567951972472,368.427457396074,368.636708743722,370.611277755662,372.277914132451,372.176918878428,373.931159065522,373.83233767387,375.991690985784,377.128855401597,377.854124371539,378.836089043264,381.763552002785,381.762586512418,383.111431080731,382.07679304717,384.164341838428,386.154825187097,385.943478575474,384.870639351765,388.344845762099,387.095044554414,389.18882984686,392.3240043213,392.615636849303,394.091668955535,394.306604861514,394.889841237517,395.075687226873,398.592913753719,398.045010598122,398.284871599332,400.865223099717,402.074440958278,403.895654774199,402.397002696395,403.609132179277,404.58377796847,405.62434257718,406.633369054298,407.704322547299,410.4418204102,409.302461708087,410.611832494079,412.652536452171,414.124772446535,413.227889196976,414.491913783862,416.523620590498,418.017754226538,417.748835411912,417.570006552611,421.709121032101,422.435069572312,421.28962885415,422.934932426344,422.240531264634,425.569722971819,427.612346798202,425.362719352895,427.220431486798,428.358823066249,429.318868606429,428.966714404382,432.500963559248,431.468201860034,433.975002360722,435.592984721025,435.801804578515,437.892008392474,437.974284929082,438.352339549414,440.646359415035,440.56616725997,443.772611184979,442.981740288837,444.852814993601,445.205162903244,442.99195140108,445.633888068671,447.575897739855,449.236803663746,447.657276879641,451.961696633381,451.395574266146,452.247122720637,452.444388407456,453.546106261999,456.056331836054,457.509369406674,455.902117040216,457.995638020551,460.535771722253,460.54696291535,464.165368501817,464.245746672748,464.59549803407,465.004884449538,466.279360782055,466.294093874732,468.628017152957,470.480213960086,471.083429910083,470.186755743336,470.381123150776,472.890344300512,474.440889370917,476.350993979809,474.681390515466,477.364384592607,478.233499835089,480.193955261259,479.97209002787,480.642701145496,480.853185863882,482.482579516406,483.637876227422,487.350554325789,488.4465313757,486.833296720516,486.956332560938,487.027065065925,490.514671633438,489.909426416265,494.284659325544,492.114382427342,494.111106429746,498.810276680711,494.891090002057,497.307566624421,496.893105527775,499.347653648822,499.126735464938,501.077303122737,501.703131357843,501.816757759567,504.011292688424,505.991601036059,507.593967453904,505.627288729071,507.750389066958,510.159424526856,508.885777652156,508.47149931115,511.064097441487,512.032760542064,514.047488592328,514.596263206502,516.231496128245,516.577627592073,518.374118394695,518.633994225003,521.190101446521,520.262672474743,522.290666645439,522.115150431716,524.208006478871,524.952269827521,524.315479353861,526.855773443381,529.180213665503,529.681399923199,530.143247630888,529.807683556287,533.169228652789,533.079201708945,533.548226247231,536.642028212801,535.230407678401,537.303360960758,539.281737421183,539.60222279517,539.692977735463,540.581581896577,542.355135530046,543.5134811146,544.018607400329,546.318448972257,545.934168000162,546.299703921682,548.537326131521,546.798217677646,550.391973743798,551.496960952424,551.77512528457,551.882856834668,553.605005396686,556.549830342236,555.256485520201,554.66828788227,558.812245442209,558.498689342799,559.489113434048,559.784635958845,561.977441371653,563.70123930043,563.41251797441,564.393272058581,567.096640215,566.75249032292,567.840098286677,568.374221749265,570.9004346356,570.005806370734,572.84925038588,573.805702288976,573.532399064009,575.848420313723,576.986769863596,577.575620288519,580.024842045418,577.037646808775,578.835079069362,579.623480786269,582.16767993447,584.58462907916,585.677888952976,585.488296698395,586.87867326256,586.85512512597,588.468971760074,589.37623547713,589.238959724943,590.706705066249,591.865158735592,594.393845816173,592.963011310302,592.885664852196,596.768278218204,596.183839379246,597.563893076839,599.904705031283,599.236913735452,600.658933020362,603.502424534235,603.528307712316,604.542191355464,604.863326644282,604.863266146697,605.503372845644,607.776614356443,611.001719227773,610.221703816214,611.164372909246,612.33262360885,612.614792000909,612.601245973442,617.675740795852,615.576313911318,616.701398488067,616.207658273147,618.751991774932,619.752696081625,620.744489621474,620.213061899907,624.784662816025,625.763586347746,625.689600221934,624.899259355576,627.714509356898,627.753529683066,628.680213834073,631.362644292955,629.772117410017,631.48878076725,632.268805000935,634.019752006877,633.42713608529,635.296666730172,637.715932088908,638.465214906423,638.026097693596,640.559217730468,638.567360254594,641.659515073298,643.71303319485,643.340962613511,644.963597377434,644.406713698473,647.847792797248,646.149611151339,648.67634936831,649.744751887497,651.060921227307,651.176508370981,654.829730484836,652.570083784218,655.254137143005,653.060226304664,657.002415808944,658.509665571262,657.915279998886,660.704832976878,661.330976349994,662.976327472976,662.156660119601,663.029420095137,663.228468651357,665.677529658354,665.661199257646,668.688156028146,669.071280652251,672.189752359279,669.842292400699,673.181688064092,672.472631638392,672.543371988689,675.572967370493,674.566622295328,675.944814981474,677.266888122578,679.210907264251,679.001079272939,682.077850323206,680.801025617492,683.216637035185,684.143087029789,683.934249908947,685.571376589298,686.343820523229,688.959394326858,690.556052636102,688.959203566212,691.93057240854,691.924554068988,691.032804650949,693.244096357355,695.461149160507,696.145106631048,694.557688678919,698.580318685452,699.655051998487,699.695491162741,700.292431767383,703.971572014478,702.910001319352,703.985982748068,703.87654306289,704.655869876624,705.476844228938,707.578031789618,710.360924464081,711.753794845335,712.568364734353,713.296755569948,712.762403748556,712.775849864319,714.67218731986,713.587549723728,716.686207126557,719.659878704646,719.130953100607,721.09588868269,721.489340956944,721.221089704551,724.743559352929,723.921612714669,724.024446207477,726.070659824739,725.481400471177,728.863779032791,729.501568385364,729.645218670353,730.511571112409,732.936293947293,731.937591613578,733.016179128296,735.42424787702,735.548686519447,737.925084796724,737.801379190188,740.1948510169,740.49554470518,738.754847425907,740.664628639582,744.282775206178,744.690795904174,744.032937332142,744.65420631498,748.033665389316,747.188223540337,750.801725478618,751.771541960379,749.545308630198,751.154345687424,751.749520340676,754.667288067904,753.709230312362,753.964996461531,759.021346994493,759.005973487612,759.817123601225,759.336011716423,760.98871876875,762.61967725621,761.718761258036,763.875738673624,765.175741654502,767.692773794473,767.642132717207,769.282233032349,769.140546973547,768.887497316819,770.660323028038,770.335235360738,773.92885176172,775.416826834716,774.937279222373,775.019097663902,778.087150251237,778.139327026561,778.613727902326,781.12358542318,780.240154342642,783.148959103229,782.157523741063,784.391413340393,785.891377242319,784.664741287446,787.398123477835,787.888413197051,789.675743916642,789.211402064621,790.913013665942,793.382284007756,793.168490163808,794.823190948275,794.779105402384,794.970608345285,796.989074309153,796.775008844559,796.40388861155,801.169122591991,799.913091183023,800.173916987354,803.995281807293,803.988138218569,804.400371605248,805.822052013398,806.574018658198,808.996658776455,809.727660708502,808.273369404136,811.353398495642,812.7268136659,813.668260975977,811.575682690716,814.764642574985,817.979633320918,817.79679453864,816.290723819354,817.336331288117,820.491109552316,820.825944514428,822.961290563877,823.293826661677,824.080999363509,825.183661842799,826.166255035391,825.730400933786,830.349493320619,827.587994592575,829.983038507218,830.455680647378,833.800112333355,834.011440176179,833.436283444093,835.205420795375,837.165461950199,839.236322839507,838.302265076169,837.957493397769,839.016457686504,843.005718580434,839.929428516142,846.055742368882,843.738649405913,844.545606740886,846.157560555464,847.933388727865,848.302828275834,847.043849777527,850.353536709469,851.450424513742,852.659550870535,851.968579272393,851.628977118639,854.675423692176,855.05570124909,856.234110001557,857.04622073328,858.601995550145,859.688782937076,861.79609271324,862.986428343876,862.205468337583,863.691182028485,865.361444766026,867.398791104838,866.943929580358,866.301126508446,869.231852545141,869.880909329029,872.77249285346,872.343422165444,872.376950217645,873.560477706171,874.494703210455,876.186035137157,877.176417797599,878.915848206825,879.320176726181,879.633312702879,880.05938870482,882.634702931419,882.937511517672,884.182837867692,886.103641018423,887.752035618649,886.046183539865,889.64408045682,888.133266470549,890.266352192195,891.222370494855,891.723091490108,894.394253041018,893.341088000222,895.660531280513,895.986744299857,896.068519701269,899.214689143466,896.911659634491,899.473847530587,899.458597433093,902.194321069901,903.264422549441,902.88126483129,905.650952956147,904.967099761418,907.659201499418,908.237829399628,909.715275947104,909.061516960806,911.095354009678,911.537180580044,911.531117843905,914.152686505522,916.773762611317,915.351929066485,916.800182524332,918.689243732977,919.036145509837,921.943536312253,921.73721373379,924.321333933022,923.348909346294,922.866083338724,925.421335267904,925.075443743186,925.992937633881,927.810525669896,929.933916700179,930.343909999578,931.814020276464,932.915341002281,932.828147869578,931.597768886391,935.795906851731,938.16911586936,937.05838349946,936.645085550472,938.632449234446,939.065482420845,940.958360779928,942.676112005557,943.866436146806,944.235175024813,944.066029866724,946.813252167282,948.34831855513,950.251882775931,948.506347565534,950.474092599153,952.193691666114,951.883604528478,953.524858555768,954.214421481278,954.865550465463,956.168509102875,957.96473276953,958.408778914004,958.533561784825,957.760217024178,960.204936814875,961.980044882656,960.485574878036,966.210952031697,963.511237770087,964.839248124381,968.457738224956,965.81012405128,969.739062681128,969.655991231457,971.455876741512,972.878110262545,972.041536077088,973.294155154251,972.003050696772,975.038947675955,977.380188253917,978.505067589582,981.0270560038,980.06462702874,981.463658648402,982.074778332694,982.513163764165,984.748910820863,985.46423458089,986.129420458393,986.18453934839,987.959849548265,989.78141697768,990.676452747463,990.517347474432,991.330886532037,993.512801321922,995.048909928954,995.121058163103,995.686707114621,996.119329269988,997.580713108728,997.517248321978,999.3026818006],"z":[109.319014181523,121.945541890784,109.655626712722,57.1132328909076,26.574600957318,13.0816834673059,76.5533119546774,12.9797681117406,70.6017773134517,63.9596885759724,11.9018666265302,80.4150617655223,105.253591738852,81.3049104880843,11.2707238809487,57.4545955803937,21.7764479989114,12.2498825549657,114.817526274345,50.9484660632257,47.516950242502,114.057781544785,63.3120693255321,12.7740649468047,19.2060050098474,104.282265487788,22.6354194966748,22.426890220181,94.0269583847099,66.7677192595262,69.6793987352611,26.0050993829868,51.2365027347833,116.245426105937,28.5429183253306,52.4815235539927,35.4333597903415,101.919683534472,142.16625915057,46.6672107321632,66.9622421443154,35.732249160865,119.24125925637,30.3364425071742,120.29969761829,38.3046527085109,120.758854547055,69.360767327755,101.463164796644,139.85061808311,38.7520389589785,115.290217651095,46.1310993585904,59.4146243765149,124.582176882145,102.839983793039,40.3302842176163,48.5474580644717,117.27876926864,63.6140771334268,68.204162400848,101.323351536154,74.8194988875469,156.552414394926,59.1753852120518,106.890597777916,84.1726412695297,101.857504659385,135.764173023846,36.874795827963,119.992571906627,145.845207643071,87.6637773140707,148.522992416333,138.168005880713,44.6064143931778,157.281610706469,101.367820294406,101.700983291025,65.0053710662652,125.482497727632,109.379228310015,117.991739287863,80.1419828580042,63.1561321364394,149.008203377456,65.8996155856576,117.200294747717,166.162073401239,111.829188934712,146.728901808468,127.665280841092,143.162739046419,51.4948428243445,117.729243504084,63.1505424834941,133.968305461944,163.122391288048,119.237566889307,121.828655447379,114.938677707791,133.266601751197,124.821842111778,62.0300796859259,71.8533855118966,176.576992745779,177.657901543093,91.0720673846863,153.185104402682,141.274427172725,105.444398821181,105.489730822431,167.784813137794,159.597087851196,90.603784778412,80.5481572729441,177.97926020917,163.605201951451,102.955126067906,165.216472606295,61.6397834894627,88.1535002004451,175.663227551494,68.0370290055685,171.378820351274,145.151667330283,90.9030936876153,65.1702343742559,74.2313968020473,160.850288884577,69.676022113777,162.721784411971,115.877827804146,164.722558803873,71.7431764296736,113.384834797352,94.3858109520725,189.606997230048,139.95772722591,125.125269788544,170.504924715841,91.9983055157435,96.8485771732945,115.457452096335,128.572883432725,85.7093868472531,149.099099367087,86.5765873886224,193.826688511586,147.211653540379,96.7243442875943,140.816751699282,83.2108378706874,99.5019879272758,81.1874437130664,129.412252520044,167.600598649064,133.631460421006,138.657687150104,127.930412843709,178.102317908216,201.137488615367,137.264422523648,116.7936705394,163.954556951042,177.892030025182,157.024540973941,129.506135156844,148.137778362728,103.080523783555,119.408811557563,107.754064667617,198.680161605566,157.273603351429,130.223289534054,123.457528536446,182.139220305906,159.875085595957,160.430097538783,169.468455722534,210.515493138554,187.363624400463,186.745503287256,110.723455933504,138.60500168289,207.162285618057,155.909915181753,97.2753203626282,150.659870238423,98.1669373854674,97.7395902067445,205.095812801126,215.715674117879,208.799895681904,204.236570447798,113.179638327115,126.567131772362,185.03006032987,180.699509406939,111.335380015848,175.04854855385,219.469498063865,117.978853732921,167.505009163059,218.413154622089,158.872173679807,153.913218202915,149.825644379039,176.100397291262,118.398452225025,187.61063504442,206.165068389288,126.410080697404,169.051173822094,125.105181175311,194.454712534485,168.503055658438,134.663286912444,199.375727275155,151.666456627381,176.245118401587,185.187876555813,206.328551412742,116.876746539989,191.108350946278,134.744511149856,201.824290219057,146.688905973982,124.589604060071,204.216702605738,209.10530859338,136.555960520543,143.19264952616,134.249538163794,157.573167560773,200.432119467141,175.921030604068,146.42636526523,125.985646214346,225.369600908209,178.221324770513,126.842159933017,162.808383839982,165.59057601192,152.318365975183,148.665312043597,159.561923432195,161.414837725555,236.148970230012,220.587694616696,138.537726549424,220.935485455248,178.324309505528,154.567543482429,128.513725179197,132.067874909844,159.161955554265,156.705057300564,168.103805067956,243.505256044671,248.050599907212,192.39076632297,152.431450627181,155.82617158327,156.874309520414,196.002755979987,143.533473226071,233.039790499218,205.835645519536,255.881243566914,244.906362958464,224.330239792688,150.706370434776,157.786335145586,179.433294737524,261.858699997155,252.187586817547,206.0723978102,170.032650275991,255.523303172905,234.785734667048,253.836532037464,223.274584163682,144.422087413356,154.339724876435,261.448102481288,254.355028920115,201.265545152093,242.951408152963,170.37963440218,184.490370410979,212.314318746698,169.435970882274,213.19414080975,191.458805538013,211.814632146778,247.715860546289,204.390103067652,185.273889072356,266.618586487223,154.529801512673,256.861375556596,207.390674301377,230.913496146549,250.402830950689,188.437292277645,168.9212485133,265.820953594224,204.990525626067,249.469280440062,169.613060919238,198.313433826258,224.69811465261,195.852560385737,213.402839019525,208.802424288573,219.199538880859,213.865751882862,192.53441838985,241.608307778642,190.708159514894,263.03871309502,262.734238599728,235.163146286717,230.353864832777,168.932485306328,216.643611255216,244.122600030272,164.366034505799,273.468352756512,178.048871067095,177.575197121715,263.5631836983,171.030035162454,210.175414703019,266.472671756022,182.91946211664,212.782694311302,210.688654648141,256.952159828008,214.886685100403,221.506519135077,210.065290045279,291.827991973632,258.217384254375,283.365226304054,290.710897271269,266.962167962864,279.506590406569,275.391466554251,287.573506838121,280.061442487006,222.938753332041,285.94927112174,277.989672573501,200.309626481745,198.616317372281,297.022227537747,234.599972732014,189.750259058882,303.0483711132,183.308277840202,243.201427626852,235.220785831208,229.965849627051,275.271102448885,218.611879078714,266.177471989269,281.822627188438,274.915740399119,308.203574986275,253.984818167168,268.780209549987,221.362709931901,236.826100008126,257.895995085575,311.151000782834,309.584378103171,216.714005810754,239.587246710246,299.57620710386,277.726465707383,233.363140378273,278.351294700371,211.969986577238,304.285720592722,304.023413439191,211.336629870719,198.517413137531,239.17435118933,243.199260860667,273.00099648407,260.04659731512,239.321042847645,238.613666940816,269.431051611909,205.236983893065,249.131626080658,231.90009836193,221.303766256724,208.234985950943,208.046680708863,322.945531654255,301.228231818004,206.354407200514,270.816686272533,205.60797143975,301.009817895624,299.523141766928,206.144133761323,307.642218369798,313.206368686254,259.569905312342,286.093935454272,259.632356639377,248.713948914298,304.477841796024,297.019147998901,324.023921273065,286.694349172629,217.840624950626,302.841424097106,324.479722901895,299.286992803173,284.854869278599,284.132993079261,258.987618083502,283.420321566915,326.475976995809,248.858543054686,318.283324276295,300.62469871176,328.537914111557,254.0762272771,265.83129828236,331.119160764997,316.370053425049,286.812435946625,296.373108136108,335.878604355328,258.205096245606,266.847554520471,341.56555384943,274.660239424269,293.081228615471,322.307529491073,282.932841862567,332.85191602065,312.257628992628,240.460148995886,307.194619764402,325.787440223167,256.332424578911,334.610513723033,286.98588371064,269.23178493427,353.055544342336,323.418306066474,288.132029083378,262.331989177339,278.325644173284,268.78554361774,327.889722208175,285.866433624711,314.497083386582,263.401950319223,270.221598431348,350.396924517658,252.30327045997,295.566004920478,335.512402516671,277.507546113358,304.885202050959,243.436942810498,323.485852897887,303.422418695393,286.766279156577,266.318146001508,245.955493351677,282.318503930144,306.353530343448,285.72573816257,365.319274504476,247.704233174892,252.075375324158,328.157536653992,263.753275746158,316.285807224766,255.352498001245,327.141063050006,289.915679505559,275.824349859596,360.83238760153,250.847151644419,303.336824364516,369.434062650929,298.469492602001,363.694509593634,261.932397870116,289.865060120422,316.271708578339,260.092710964075,357.421908414113,304.885074298099,376.259909388642,313.257757960668,366.368572875421,256.250838629311,278.807833892819,302.759821985123,293.297427837124,321.802431032,347.28640034776,376.20643894415,319.398331691961,274.560029925311,334.45300134977,383.077102039594,271.247207065709,372.207957502206,302.173280321561,320.094974901306,283.418533838024,306.008880156564,284.55795689778,344.209592108813,292.976578007226,376.440553965025,307.06380098439,380.510325872449,327.419277467984,337.522479604771,358.617267791747,293.740496571098,306.074601754842,375.745084570923,293.040847016343,375.688622053832,388.02192542342,304.243383439879,375.377401663092,289.070754594356,366.259666686547,327.770472546334,392.258584287325,352.399174557397,293.837549343595,325.005510942904,396.41955776842,293.465375784465,386.872388348568,300.531717263833,353.794098192357,375.968875483649,369.61189967081,371.779163820737,343.47411687222,357.947014298209,336.359327923866,311.62288211212,287.381908175448,335.407260085515,378.067182386179,297.997560253198,405.337850872546,385.046276667324,406.148235208558,288.502485847956,355.270312850279,335.439892442204,342.382241326175,336.627861354353,358.227235800439,319.414468894267,396.973050397396,412.382598953835,404.919182264601,412.822216140376,371.302244980382,327.506938457983,398.583392929676,374.949365119609,353.04610988284,370.992460981207,378.954583032194,377.256103985627,403.728499959574,380.084517701079,419.576991277157,326.126780750212,355.234995380944,297.85387696135,328.350934272872,337.573020406965,380.987917738233,391.747232535471,341.100397796229,333.923451750508,391.898440495709,378.180402892743,379.607446536463,328.373292526419,414.87470559209,375.416290289018,323.538814005847,388.115528012149,317.374676067949,369.929783797272,422.689130218179,323.673731458841,379.181283699672,415.867712105734,328.67334882832,365.504504949133,325.851728865572,320.316905171921,344.719281393086,339.236414365931,399.757913443737,376.972493267293,347.811268986694,335.515816726496,425.718298661826,316.562297177457,387.212953204319,331.587940950577,385.8846602382,370.74796406234,376.14615021411,381.116551122065,363.069640588056,431.984432202196,370.4944326384,347.600247743049,426.638942959559,340.656656400527,329.969452316408,349.011287442682,426.935335663875,424.209242875438,365.255920759084,344.403270715791,417.77150422619,376.933796577283,382.079554155154,445.183798430591,334.859627814845,335.710589251604,403.87768233367,349.75356160456,358.215874210635,365.639418792494,435.654519688621,333.153593981708,353.05239099997,398.797379484918,333.113822140987,331.388949299957,353.797535307117,372.79839469148,366.039405600807,354.535840420903,356.84187918612,360.738982163513,382.819847114951,441.315571352647,367.641877409753,428.241352003035,377.096668503844,455.560354830781,413.778189508865,441.959571583042,351.653611232174,406.099259436421,434.696467198545,370.064077248542,400.608749864518,411.868815388191,400.14685697798,415.817751823108,343.377370651587,388.550236791046,389.256648126595,350.461683762343,378.386862647791,438.485707422994,443.534050416839,369.743754391897,459.621522201395,357.509934392006,457.093218203706,410.160042191721,362.60592137504,389.058813884849,374.240331701175,451.624049675114,405.931219567621,391.176764765479,367.745057837961,458.43275318636,357.113436538099,428.228278580814,449.681288433839,424.427327503763,418.11532093891,403.9781441697,444.434605877647,464.344515521804,369.149613036632,395.956916724367,401.736717854757,388.067759850984,371.53427942926,429.564900748074,382.847406176127,429.865927251067,432.252544318026,481.563302618904,385.475011363883,390.617224579456,380.653141022117,459.451360114532,373.904345028304,419.016684247244,371.725422450436,480.211389101366,387.384167207171,453.538296434144,484.099228539262,457.643563536225,397.381676544515,442.800607254441,382.836649465684,389.278199148766,377.598001701827,401.784813588764,423.74732116889,457.882623887478,413.147209126571,388.932403228389,444.876993674071,481.993448102322,420.408311702465,384.439463160503,473.159714631525,387.424086701805,469.291610746069,389.578846630762,481.76690487395,442.538973891835,449.660295925157,483.670365564046,484.617153039137,384.553482424041,435.863519021364,420.301462139878,482.07667041449,445.412799772221,434.358730881478,386.887226716913,411.469001671807,430.915712824411,395.081350446032,434.671755935709,412.442589384657,489.739729909854,412.038679414202,477.784598862973,474.249963672071,396.617483242824,445.318171489414,401.47656509902,419.761838569272,415.734430316789,410.547221115052,389.91176988568,505.624320722354,404.164818586929,440.206637439617,488.926878484596,403.543599654434,433.986566857016,432.988684016525,488.898095449212,459.868739057807,491.062621371232,493.298183993964,421.960340133325,452.938628243891,435.095846206989,463.544507179876,517.791749151138,415.204749949,442.666148956004,495.833130644598,471.068793572499,465.970953335003,507.929503333609,495.029295241567,456.64696810986,517.610031230686,470.367110856163,473.123836080114,415.410674584836,450.945369242387,525.140263685558,431.074998679818,431.757072637914,439.953289074683,419.470989266323,428.105057222608,441.737630528475,487.201512257628,526.43829900361,416.328034394926,413.234717034701,413.756816249171,460.688280870689,440.617100780311,423.69693194085,518.066417304437,430.164374740434,480.183430721436,475.860815199864,451.366543857634,498.413783843385,506.737577822966,533.652180407093,459.473819630298,458.282450842858,472.142711493298,500.038115170603,482.889328536959,417.211719355323,525.285524660608,487.902074259056,531.799064102989,537.866312498976,531.760413631887,506.497420179035,525.529414099871,478.380945898639,500.901396217252,476.822265766887,543.6265430502,457.983001325329,546.166945160636,509.4413571966,537.511726746826,508.835744887189,477.245682201339,542.588167463138,444.887011438987,428.534951866283,499.481462089626,491.356555488845,464.479344829938,463.311879120175,505.442796300178,478.73696268727,467.071978455639,479.488572587771,533.994195365247,461.045301833651,555.8051292627,510.28042925296,537.545448846962,463.152273020808,530.920631051231,442.316921486224,500.305578954867,543.71242991726,559.519505353936,486.485402014231,495.909123932601,490.628448572359,552.998460064125,499.518259188184,557.381084563437,455.430685484957,510.728339623948,532.563265033364,441.55569314887,520.59015762586,489.11669096564,454.158243268933,527.786140510657,520.555738330006,456.295704272614,494.929676400189,457.845813622407,545.251734646155,549.052632551729,497.46207373438,447.988542849651,524.069236511912,522.30924554775,563.073353886255,498.221791357222,570.393496492829,482.00139690174,468.645054766917,517.222908632723,508.478648157645,517.878034991322,463.453949959207,528.358487256656,539.4989126088,523.348373414974,532.293562792405,492.553361089965,491.446760490731,531.380624753301,477.997186601613,572.616832976141,581.701785140151,551.908591199948,520.739637096885,576.110261802716,537.615758602025,509.64731135806,486.127582562006,551.597087070556,578.488030007076,549.185819708294,573.841477209101,491.831467798706,532.273750189038,490.608378118629,532.217200249489,586.863227224542,566.633073578908,491.962889969354,516.480299897819,571.339586191976,523.683156138992,517.896251312038,472.522357917996,486.391375590484,554.414423621492,478.300598565464,595.861304732755,485.947736170527,550.225356325298,475.464826930672,481.796117935672,497.379242077171,574.586901207981,578.729614018601,565.704486979442,510.877159782654,556.333739010175,596.479449799986,544.192235946984,531.398052408255,568.556969783847,500.506699302846,519.142742367865,527.880607746089,486.251792677719,515.041804757996,570.426734596702,521.939654015524,557.734631633919,547.617911605106,590.278453020579,550.460592550593,497.380269165963,581.671450909526,492.781472469772,573.774627644324,492.376512544225,583.924966387724,584.840946602604,555.822730149077,594.648287718329,514.829052670445,517.883173204931,574.183067819772,545.614076815247,573.124082728952,500.746431314466,534.28432509679,593.119077734371,536.237978054129,499.542655210723,601.206484947712,563.604894182579,608.439771246146,590.331192216117,563.572067206222,555.567972001258,540.05711949215,568.288203025545,616.376412938782,530.594053005056,511.630512496925,530.614918320809,521.7422955869,566.249285454319],"type":"scatter3d","mode":"markers","marker":{"color":"rgba(31,119,180,0.25)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,0.25)"},"error_x":{"color":"rgba(31,119,180,0.25)"},"line":{"color":"rgba(31,119,180,0.25)"},"frame":null},{"colorbar":{"title":"artificial_data$y","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,0.25)"],["0.0416666666666667","rgba(70,19,97,0.25)"],["0.0833333333333333","rgba(72,32,111,0.25)"],["0.125","rgba(71,45,122,0.25)"],["0.166666666666667","rgba(68,58,128,0.25)"],["0.208333333333333","rgba(64,70,135,0.25)"],["0.25","rgba(60,82,138,0.25)"],["0.291666666666667","rgba(56,93,140,0.25)"],["0.333333333333333","rgba(49,104,142,0.25)"],["0.375","rgba(46,114,142,0.25)"],["0.416666666666667","rgba(42,123,142,0.25)"],["0.458333333333333","rgba(38,133,141,0.25)"],["0.5","rgba(37,144,140,0.25)"],["0.541666666666667","rgba(33,154,138,0.25)"],["0.583333333333333","rgba(39,164,133,0.25)"],["0.625","rgba(47,174,127,0.25)"],["0.666666666666667","rgba(53,183,121,0.25)"],["0.708333333333333","rgba(79,191,110,0.25)"],["0.75","rgba(98,199,98,0.25)"],["0.791666666666667","rgba(119,207,85,0.25)"],["0.833333333333333","rgba(147,214,70,0.25)"],["0.875","rgba(172,220,52,0.25)"],["0.916666666666667","rgba(199,225,42,0.25)"],["0.958333333333333","rgba(226,228,40,0.25)"],["1","rgba(253,231,37,0.25)"]],"showscale":true,"x":[0,200,400,600,800,1000],"y":[0,200,400,600,800,1000],"z":[[61.2068979626935,129.015027692809,196.823157422925,264.631287153041,332.439416883157,400.247546613273],[93.6518722591435,161.460001989259,229.268131719375,297.076261449491,364.884391179607,432.692520909723],[126.096846555594,193.904976285709,261.713106015825,329.521235745941,397.329365476057,465.137495206173],[158.541820852043,226.349950582159,294.158080312275,361.966210042391,429.774339772507,497.582469502623],[190.986795148493,258.794924878609,326.603054608725,394.411184338841,462.219314068957,530.027443799073],[223.431769444943,291.239899175059,359.048028905175,426.856158635291,494.664288365407,562.472418095523]],"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb5" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Multicollinearity: An Intuitive Example"</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Eros Rojas"</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2023-01-08"</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [R, Statistics]</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> "colinear.jpg"</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "Show the code"</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: scroll</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="fu">## **An intuitive visualization of collinearity**</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>Visualized in 3 dimensions, with the help of plotly.</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="al">![](3d.jpg)</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="fu">### **Understanding what collinearity is:**</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>As defined by <span class="kw">&lt;a</span> <span class="er">href</span><span class="ot">=</span><span class="st">"https://en.wikipedia.org/wiki/Multicollinearity"</span> <span class="er">target</span><span class="ot">=</span><span class="st">"_blank"</span><span class="kw">&gt;</span>Wikipedia<span class="kw">&lt;/a&gt;</span>, "*multicollinearity (also collinearity) is a phenomenon in which one predictor variable in a multiple regression model can be linearly predicted from the others with a substantial degree of accuracy.*" Essentially, this means that an input variable (or multiple variables) is highly correlated with another input variable, to the extent that their relationship is virtually linearly dependent. This can cause numerous issues with respect to the regression analysis, most notably causing: </span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;ul&gt;</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;li&gt;</span>Inflated standard error<span class="kw">&lt;/li&gt;</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;li&gt;</span>Uninterpretable + Unstable coefficients<span class="kw">&lt;/li&gt;</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/ul&gt;</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>All of these issues will be explained in the following 3 sections.</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **Inflated standard error:**</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>The standard error of the coefficients of a linear model can be calculated as follows: </span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;&lt;br&gt;</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>Lets assume a linear model has the following loss function</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>$$f(w) = ||Xw + \epsilon - \hat{y}||_2$$</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>where $\epsilon$ represents the error terms which follow a normal distribution, such that $\epsilon \sim N(0, \sigma^2)$. Since the given loss function above is fully differentiable and convex, we can find a closed-form solution for its coefficients as</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>$$w = (X^TX)^{-1}X^T\hat{y}$$</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>Now that the coefficients are isolated, finding the variance should be quite straight forward.</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>\mathrm{Var}(w) &amp;= \mathrm{Var}\left((X^TX)^{-1}X^T \hat{y} \right) <span class="sc">\\</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>&amp;= (X^TX)^{−1}X^T \cdot \mathrm{Var}(\hat{y}) \cdot X(X^TX)^{−1} <span class="sc">\\</span></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>&amp;= \sigma^2 (X^T X)^{-1}</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>*Note: $\mathrm{Var}(\hat{y}) = \mathrm{Var}(\epsilon)$ due to the fact that $\hat{y} = Xw + \epsilon$, and $Xw$ has a variance of 0 (since $Xw$ is not a random variable)*.</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;&lt;br&gt;</span></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>It is clear that $X^T X$ must be a square matrix, therefore, it can be diagonalized such that </span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>$$X^T X = PDP^{-1}$$</span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>where $P$ is an invertible matrix containing linearly independent eigenvectors of $X^T X$, and $D$ is a diagonal matrix containing the eigenvalues of $X^T X$ (you can read more about matrix diagonalization <span class="kw">&lt;a</span> <span class="er">href</span><span class="ot">=</span><span class="st">"https://www.statlect.com/matrix-algebra/matrix-diagonalization"</span> <span class="er">target</span><span class="ot">=</span><span class="st">"_blank"</span><span class="kw">&gt;</span>here<span class="kw">&lt;/a&gt;</span>). Most notably, the product of the entries of $D$ (the eigenvalues) are equal to the determinant of $D$. When multicollinearity is present, $X^T X$ becomes 'nearly singular' (a matrix which has a determinant very close to $0$, and who's columns are nearly linearly dependent. For reference, a non-singular matrix is linearly independent, and a singular matrix is linearly dependent and has a determinant of $0$). In other words, this means that one or more of the eigenvalues of $D$ must be very close to $0$, or in fact $0$. Given the inverse of the diagonalized matrix above;</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>$$(X^T X)^{-1} = PD^{-1}P^{-1}$$</span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>this means that with multicollinearity, $D^{-1}$ must have very large values. This is due to the fact that when the inverse of a matrix is taken, its determinant is essentially divided out from each element of the resulting matrix (this is an oversimplification, look into <span class="kw">&lt;a</span> <span class="er">href</span><span class="ot">=</span><span class="st">"https://en.wikipedia.org/wiki/Adjugate_matrix"</span> <span class="er">target</span><span class="ot">=</span><span class="st">"_blank"</span><span class="kw">&gt;</span>adjugate matrices<span class="kw">&lt;/a&gt;</span> if you are interested). This causes $(X^T X)^{-1}$ to subsequently also have very large values, which finally causes $\mathrm{Var}(w)$ to be very large. This shows why multicollinearity severely inflates the standard error of the coefficients.</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **Uninterpretable + Unstable coefficients:**</span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a><span class="fu">### **Intuition behind the instability:**</span></span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>It might be a little difficult to digest exactly why the coefficients become highly unstable from the above explanation. To help give a visual aspect to the problem of collinearity, the following simulation was created to replicate the effects, and issues that arise with collinear features.</span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, results='hide', message=FALSE, warning = FALSE}</span></span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a><span class="co"># installing packages</span></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("plotly", repos = "http://cran.us.r-project.org")</span></span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, collapse = FALSE, results="hold"}</span></span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>artificial_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">1000</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">x2 =</span> x1 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> (x1 <span class="sc">+</span> x2 <span class="sc">+</span> <span class="fu">runif</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="dv">500</span>))<span class="sc">/</span><span class="dv">4</span>) </span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>artificial_data <span class="sc">%&gt;%</span></span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cor</span>()</span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a><span class="co">#change the values inside of slice to subset the data differently (this will drastically change the coefficients of x1 and x2 since they are colinear)</span></span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a>lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> <span class="fu">slice</span>(artificial_data, <span class="dv">200</span><span class="sc">:</span><span class="dv">700</span>))</span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a>lm</span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, collapse = FALSE, results="hold"}</span></span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">x1 =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1000</span>, <span class="at">by =</span> <span class="dv">200</span>), <span class="at">x2 =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1000</span>, <span class="at">by =</span> <span class="dv">200</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">preds =</span> <span class="fu">predict</span>(lm, <span class="at">newdata =</span> <span class="fu">data.frame</span>(x1, x2))) <span class="sc">%&gt;%</span></span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> x1, <span class="at">values_from =</span> preds) <span class="sc">%&gt;%</span> </span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb5-99"><a href="#cb5-99" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.matrix</span>()</span>
<span id="cb5-100"><a href="#cb5-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-101"><a href="#cb5-101" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(mtcars, <span class="at">x =</span> <span class="sc">~</span>artificial_data<span class="sc">$</span>x1, <span class="at">y =</span> <span class="sc">~</span>artificial_data<span class="sc">$</span>x2, <span class="at">z =</span> <span class="sc">~</span>artificial_data<span class="sc">$</span>y, <span class="at">alpha =</span> <span class="fl">0.25</span>)</span>
<span id="cb5-102"><a href="#cb5-102" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_markers</span>()</span>
<span id="cb5-103"><a href="#cb5-103" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">layout</span>(<span class="at">scene =</span> <span class="fu">list</span>(<span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'x1'</span>),</span>
<span id="cb5-104"><a href="#cb5-104" aria-hidden="true" tabindex="-1"></a>                     <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'x2'</span>),</span>
<span id="cb5-105"><a href="#cb5-105" aria-hidden="true" tabindex="-1"></a>                     <span class="at">zaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'y'</span>, <span class="at">nticks =</span> <span class="dv">5</span>, <span class="at">range =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1000</span>))))</span>
<span id="cb5-106"><a href="#cb5-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-107"><a href="#cb5-107" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">add_trace</span>(<span class="at">p =</span> fig,</span>
<span id="cb5-108"><a href="#cb5-108" aria-hidden="true" tabindex="-1"></a>                <span class="at">z =</span> grid,</span>
<span id="cb5-109"><a href="#cb5-109" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1000</span>, <span class="at">by =</span> <span class="dv">200</span>),</span>
<span id="cb5-110"><a href="#cb5-110" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1000</span>, <span class="at">by =</span> <span class="dv">200</span>),</span>
<span id="cb5-111"><a href="#cb5-111" aria-hidden="true" tabindex="-1"></a>                <span class="at">type =</span> <span class="st">"surface"</span>)</span>
<span id="cb5-112"><a href="#cb5-112" aria-hidden="true" tabindex="-1"></a>p2</span>
<span id="cb5-113"><a href="#cb5-113" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>